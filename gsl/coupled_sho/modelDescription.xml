<?xml version="1.0" encoding="UTF-8"?>
<fmiModelDescription
  fmiVersion="2.0"
  description="Normalized coupled simple harmonic oscillator"
  modelName="coupled_sho"
  guid="{e447a3ab-8844-4206-a525-ec659bee2e37}"
  numberOfEventIndicators="0">

<CoSimulation
  modelIdentifier="coupled_sho"
  canHandleVariableCommunicationStepSize="true"
  canGetAndSetFMUstate="true"
  providesDirectionalDerivative="true"/>

<LogCategories>
  <Category name="logAll"/>
  <Category name="logError"/>
  <Category name="logFmiCall"/>
  <Category name="logEvent"/>
</LogCategories>

<DefaultExperiment startTime="0" stopTime="10" stepSize="0.1"/>

<ModelVariables>
    <!-- parameters for coupling -->
    <ScalarVariable name="mu"       valueReference="0"  description="mass ratio wrt outside"                    causality="parameter" variability="fixed"><Real start="1"/></ScalarVariable>
    <ScalarVariable name="omega"    valueReference="1"  description="(normalized) spring constant from outside" causality="parameter" variability="fixed"><Real start="1"/></ScalarVariable>
    <ScalarVariable name="zeta_c"   valueReference="2"  description="damping constant of coupling"              causality="parameter" variability="fixed"><Real start="1"/></ScalarVariable>
    <ScalarVariable name="x0"       valueReference="3"  description="reference position for the spring"         causality="parameter" variability="fixed"><Real start="1"/></ScalarVariable>

    <!-- internal parameter -->
    <ScalarVariable name="zeta"     valueReference="4"  description="internal damping constant"                 causality="parameter" variability="fixed"><Real start="1"/></ScalarVariable>

    <!-- inputs -->
    <ScalarVariable name="v0"       valueReference="5"  description="external driving velocity"                 causality="input" initial="exact"><Real start="0"/></ScalarVariable>
    <ScalarVariable name="force"    valueReference="6"  description="driving force"                             causality="input" initial="exact"><Real start="0"/></ScalarVariable>

    <!-- variables which are not reported but must be initialized -->
    <ScalarVariable name="xstart"   valueReference="7"  description="initial position"                          causality="parameter" variability="fixed"><Real start="1"/></ScalarVariable>
    <ScalarVariable name="vstart"   valueReference="8"  description="initial velocity"                          causality="parameter" variability="fixed"><Real start="1"/></ScalarVariable>
    <ScalarVariable name="dxstart"  valueReference="9"  description="(estimated) angle difference"              causality="parameter" variability="fixed"><Real start="1"/></ScalarVariable>

    <!-- outputs -->
    <ScalarVariable name="force_c"  valueReference="10" description="value of coupling force at last step."     causality="output"><Real /></ScalarVariable>
    <ScalarVariable name="x"        valueReference="11" description="position"                                  causality="output"><Real /></ScalarVariable>
    <ScalarVariable name="v"        valueReference="12" description="velocity"                                  causality="output"><Real /></ScalarVariable>
</ModelVariables>

<ModelStructure>
  <Outputs>
    <Unknown index="11"/>
  </Outputs>
  <Derivatives/>
  <DiscreteStates/>
  <InitialUnknowns />
</ModelStructure>

</fmiModelDescription>
